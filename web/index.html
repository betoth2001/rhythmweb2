<html>
<head>
	<title>Rhythmbox REST/Ajax Web Control</title>
	<script type="text/javascript" src="jquery-1.4.4.js"></script>
	<script type="text/javascript" src="common.js"></script>
	<script type="text/javascript" src="player.js"></script>
	<LINK href="style.css" rel="stylesheet" type="text/css">
	
	<!-- 
	<script type="text/javascript" src="player.js"></script>
	-->
</head>
<body>
	<script type="text/javascript">
	
	$(document).ready(function() {
		$.getJSON('rest/playlist', function(json) {
			$('#playlist').html('');
			if (json && json.entries) {
				$.each(json.entries, function(index, entry) {
					var line_id = 'track_line_' + index;
					var container_id = 'actions_' + index;

					
					var playlist = '';
					playlist += '<div id="' + line_id + '" class="line">';
					playlist += '<span id="track_number">' + entry.track_number + '</span>';
					playlist += '<span id="track_title">' + entry.title + '</span>';
					playlist += '<span id="track_genre">' + entry.genre + '</span>';
					playlist += '<span id="track_artist">' + entry.album + '</span>';
					playlist += '<span id="track_album">' + entry.album + '</span>';
					playlist += '<span id="track_duration">' + human_time(entry.duration) + '</span>';
					playlist += '<span id="track_actions"><span id="' + container_id + '"></span></span>';
					playlist += '</div>';
					$('#playlist').append(playlist);

					entry_id = entry.id;
					
					add_dequeue_action(line_id, container_id, entry_id);
					// add
					// remove
					// rate
				});
			}
		});
	});

	function add_dequeue_action(line_id, container_id, entry_id) {
		var action_id = container_id + '_dequeue';
		var dequeue = '<img id="' + action_id + '" class="link" src="img/remove.svg" />';
		$('#' + container_id).append(dequeue);
		$('#' + action_id).click(function() {
			$.post("rest/player", { action: "dequeue", "entry_id" : entry_id }, function(data) {
				$('#' + line_id).fadeOut('slow');
			});
		});
	}
	
	</script>
	<div id="player">
		<span id="player_buttons">
			<img id="previous" class='link' src='img/previous.svg'/>
			<img id="seek_back" class='link' src='img/seek-backward.svg'/>
			<span id="play_pause" class='link'>
				<span id='play'><img src='img/play.svg'/></span>
				<span id='pause'><img src='img/pause.svg'/></span>
			</span>
			<img id="seek_forward" class='link' src='img/seek-forward.svg'/>
			<img id="next" class='link' src='img/next.svg'/>
		</span>
		<span id="title"></span>
		<span id="artist"></span>
		<span id="album"></span>
		<span id='time'></span>
	</div>
	<div id="playlist">
	</div>
</body>
</html>